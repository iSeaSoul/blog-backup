<h3>Original Link: <a href=http://ryan-daily.diandian.com/cpp-primer-reading-note-3>http://ryan-daily.diandian.com/cpp-primer-reading-note-3</a></h3>
<article>
 <h3 data-postname="Pattern Translations">
  <a href="#" onclick="return false" style="cursor:default;">
   C++ Primer Reading Note 3 - decltype &amp; typeid
  </a>
 </h3>
 <p class="date ">
  4th of June 2015
 </p>
 <p class="date " style="margin-top:-1.2em;">
  <a href="/?tag=cplusplus" target="_blank">
   cplusplus
  </a>
  <a href="/?tag=primer" target="_blank">
   primer
  </a>
  <a href="/?tag=reading-note" target="_blank">
   reading-note
  </a>
 </p>
 <!-- 内容页面 全文 -->
 <p>
 </p>
 <p>
  The two function are similar: provide a way to deduce the type of a variable(or more formally, expression).
 </p>
 <p>
  <code>
   decltype((x))
  </code>
  and
  <code>
   decltype(x = y)
  </code>
  both indicates
  <code>
   T&amp;
  </code>
  , a reference.
 </p>
 <p>
  For a pointer,
  <code>
   typeid
  </code>
  only show the direct pointed type. While for a reference, it can deduce its in-memory type.
 </p>
 <p>
  Also they can deduce the type of a type statement.
 </p>
 <pre config="brush:cpp;toolbar:false;">
namespace test_decltype_and_typeid {

struct Base {}; // non-polymorphic
struct Derived : Base {};

struct Base2 { virtual void foo() {} }; // polymorphic
struct Derived2 : Base2 { };

void test() {
    int x = 1;
    decltype(x) y = x;
    decltype((x)) z = x;
    y = 2;
    z = 3;

    cout &lt;&lt; typeid(y).name() &lt;&lt; ' ' &lt;&lt; typeid(z).name() &lt;&lt; endl; // i i
    cout &lt;&lt; x &lt;&lt; ' ' &lt;&lt; y &lt;&lt; ' ' &lt;&lt; z &lt;&lt; endl; // 3 2 3

    decltype(y = x) zz = x;
    zz = 4;

    cout &lt;&lt; x &lt;&lt; ' ' &lt;&lt; y &lt;&lt; ' ' &lt;&lt; z &lt;&lt; ' ' &lt;&lt; zz &lt;&lt; endl; // 4 2 4 4

    Base* bx = new Derived;
    Base2* by = new Derived2;

    cout &lt;&lt; typeid(bx).name() &lt;&lt; ' ' &lt;&lt; typeid(by).name() &lt;&lt; endl;
    // PN13test_decltype4BaseE PN13test_decltype5Base2E

    Derived dx;
    Base &amp;bxx = dx;
    Derived2 dy;
    Base2 &amp;byy = dy;
    cout &lt;&lt; typeid(bxx).name() &lt;&lt; ' ' &lt;&lt; typeid(byy).name() &lt;&lt; endl;
    // N13test_decltype4BaseE N13test_decltype8Derived2E

    cout &lt;&lt; typeid(map&lt;int, int&gt;).name() &lt;&lt; endl;
}

}
</pre>
 <p>
  More reference:
  <a href="http://en.cppreference.com/w/cpp/language/typeid">
   http://en.cppreference.com/w/cpp/language/typeid
  </a>
  .
 </p>
 <p>
  Powered By 点点网
  <a href="http://www.diandian.com/?ref=crawler">
   点点网
  </a>
 </p>
 <p>
 </p>
 <div class="footnotes">
  <hr>
   <div id="notes" style="">
    <a name="jjlnotes">
    </a>
    <iframe allowtransparency="true" frameborder="0" height="0" id="diandian_comments" scrolling="no" src="http://www.diandian.com/n/common/comment?feedId=d99d8660-0aa1-11e5-86d5-d4ae52a7bec4&amp;notesTextColor=%23131313&amp;notesLinkColor=%23131313&amp;notesBlockQuoteColor=&amp;notesBlockBgColor=%23ffffff&amp;notesBlockBorderColor=&amp;notesBlockBgOpacity=0&amp;notesOperationLinkColor=&amp;notesEnableBorderRadius=&amp;notesIframeId=" width="530">
    </iframe>
   </div>
  </hr>
 </div>
</article>
